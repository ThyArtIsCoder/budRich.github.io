<!doctype html>
<html>
<head>
    <base href="https://budrich.github.io/">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="author" content="">

<meta name="description" content="">

<title>i3fyra</title>
<meta name="generator" content="Hugo 0.30.2" />
<link  href="https://budrich.github.io/stylesheets/styles.css" rel="stylesheet" type="text/css">

</head>
<body>




<input type="checkbox" id="sidebar" name="sidebar" class="sidebar-checkbox"/>
<div class="sidebar">
  <div class="sbbg">
    <div class="sbcontent">
      <a href="https://budrich.github.io/"  class="logo"><pre class="logo">
▗▄▄      ▐  ▗      ▐      
▐  ▌▗ ▗ ▄▟  ▐    ▄▖▐▄▖ ▄▖ 
▐▄▄▘▐ ▐▐▘▜  ▐   ▝ ▐▐▘▜▐ ▝ 
▐  ▌▐ ▐▐ ▐  ▐   ▗▀▜▐ ▐ ▀▚ 
▐▄▄▘▝▄▜▝▙█  ▐▄▄▖▝▄▜▐▙▛▝▄▞ 

[OC] by budRich since 2017
</pre>
</a>
      <label class="sidebar-toggle" for="sidebar"><span>Toggle</span></label>
      <div class="css-treeview box">  
          <ul>
            <li><a href="https://budrich.github.io/abouts/whoami"><span class="glyphicon glyphicon-briefcase"></span>about</a></li>
            <li>
              <li>
                <input type="checkbox" id="blog" checked />
                <label for="blog" class="section-item"><span class="glyphicon glyphicon-home"></span>blog</label>
                <ul>
                  
                  
                  
                  
                  
                    
                      
                      
                      
                      
                        
                        <li><li>
                        <input type="checkbox" id="2017" 
                        
                          checked
                         />
                        <label for="2017">2017</label><ul>
                        
                        
                      
                      
                        
                        <li><li>
                        <input type="checkbox" id="November" 
                        
                          checked
                         />
                        <label for="November">November</label><ul>
                        
                        
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/extreme_i3/"><span class="tree-date">21</span>|<span>extreme_i3</span></a></li>
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                      
                      
                      
                      
                      
                        
                          </ul></li></li>
                        
                        <li><li>
                        <input type="checkbox" id="October" 
                         />
                        <label for="October">October</label><ul>
                        
                        
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/sublime_setup/"><span class="tree-date">17</span>|<span>sublime_setup</span></a></li>
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                      
                      
                      
                      
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/fresh_start/"><span class="tree-date">01</span>|<span>fresh_start</span></a></li>
                      
                    
                  
                    
                      
                      
                      
                      
                      
                        
                          </ul></li></li>
                        
                        <li><li>
                        <input type="checkbox" id="September" 
                         />
                        <label for="September">September</label><ul>
                        
                        
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/perfect_folders/"><span class="tree-date">29</span>|<span>perfect_folders</span></a></li>
                      
                    
                  
                    
                      
                      
                      
                      
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/mouseback/"><span class="tree-date">25</span>|<span>mouseback</span></a></li>
                      
                    
                  
                    
                      
                      
                      
                      
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/swedish_keyboards/"><span class="tree-date">25</span>|<span>swedish_keyboards</span></a></li>
                      
                    
                  
                    
                      
                      
                      
                      
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/me_myself_and_i3/"><span class="tree-date">25</span>|<span>me_myself_and_i3</span></a></li>
                      
                    
                  
                    
                      
                      
                      
                      
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/install_i3/"><span class="tree-date">25</span>|<span>install_i3</span></a></li>
                      
                    
                  
                    
                      
                      
                      
                      
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/i3_setup/"><span class="tree-date">25</span>|<span>i3_setup</span></a></li>
                      
                    
                  
                    
                      
                      
                      
                      
                      
                      
                        <li class="post-in-tree"><a href="https://budrich.github.io/blog/font_rendering/"><span class="tree-date">25</span>|<span>font_rendering</span></a></li>
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                      
                      
                      
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                </ul></li></li>
                </ul></li></li>
                </ul></li></li>

            
  
    
      <li>
        <li>
          <input type="checkbox" id="scripts" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="scripts" class="section-item"><span class="glyphicon 
            glyphicon-console"></span>scripts</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/scripts/igi/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >igi</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/scripts/subact/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >subact</span>
                  </a>
                </li>
            
            <ul>
            
  

            </ul>
          </ul>
        </li>
      </li>
    
  
    
      <li>
        <li>
          <input type="checkbox" id="i3ass" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          
            checked
          

          />
          
            <label for="i3ass" class="section-item"><span class="glyphicon 
            glyphicon-th-large"></span>i3ass</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/i3ass/readme/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >README</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/i3ass/i3fyra/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                      class="active-page"
                    
                  >i3fyra</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/i3ass/i3list/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >i3list</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/i3ass/i3term/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >i3term</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/i3ass/i3zen/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >i3zen</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/i3ass/i3run/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >i3run</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/i3ass/i3mtm/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >i3mtm</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/i3ass/i3gw/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >i3gw</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/i3ass/i3get/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >i3get</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/i3ass/i3cast/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >i3cast</span>
                  </a>
                </li>
            
            <ul>
            
  

            </ul>
          </ul>
        </li>
      </li>
    
  
    
  
    
  
    
      <li>
        <li>
          <input type="checkbox" id="dots" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="dots" class="section-item"><span class="glyphicon 
            glyphicon-cog"></span>dots</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/profile/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >profile</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/bashrc/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >bashrc</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/xresources/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >Xresources</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/xinitrc/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >xinitrc</span>
                  </a>
                </li>
            
            <ul>
            
  
    
      <li>
        <li>
          <input type="checkbox" id="bash" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="bash">bash</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/bash/prompt/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >prompt</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/bash/func/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >func</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/bash/misc/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >misc</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/bash/export/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >export</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/bash/alias/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >alias</span>
                  </a>
                </li>
            
            <ul>
            
  

            </ul>
          </ul>
        </li>
      </li>
    
  
    
      <li>
        <li>
          <input type="checkbox" id="xres" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="xres">xres</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/xres/urxvt/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >urxvt</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/xres/xft/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >xft</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/xres/color/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >color</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/xres/i3wm/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >i3wm</span>
                  </a>
                </li>
            
            <ul>
            
  
    
      <li>
        <li>
          <input type="checkbox" id="colors" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="colors">colors</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/xres/colors/hatofgod/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >HatOfGod</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/xres/colors/solarized-dark/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >solarized-dark</span>
                  </a>
                </li>
            
            <ul>
            
  

            </ul>
          </ul>
        </li>
      </li>
    
  

            </ul>
          </ul>
        </li>
      </li>
    
  
    
      <li>
        <li>
          <input type="checkbox" id="sublime" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="sublime">sublime</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/sublime/keymap/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >keymap</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/sublime/settings/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >settings</span>
                  </a>
                </li>
            
            <ul>
            
  
    
      <li>
        <li>
          <input type="checkbox" id="schemes" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="schemes">schemes</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/sublime/schemes/solarized_dark/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >solarized_dark</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/sublime/schemes/solarized_light/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >solarized_light</span>
                  </a>
                </li>
            
            <ul>
            
  

            </ul>
          </ul>
        </li>
      </li>
    
  

            </ul>
          </ul>
        </li>
      </li>
    
  
    
      <li>
        <li>
          <input type="checkbox" id="irssi" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="irssi">irssi</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/irssi/bud/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >bud</span>
                  </a>
                </li>
            
            <ul>
            
  

            </ul>
          </ul>
        </li>
      </li>
    
  
    
      <li>
        <li>
          <input type="checkbox" id="config" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="config">config</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/config/user-dirs/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >user-dirs</span>
                  </a>
                </li>
            
                <li>
                  <a href="https://budrich.github.io/dots/config/compton/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >compton</span>
                  </a>
                </li>
            
            <ul>
            
  
    
      <li>
        <li>
          <input type="checkbox" id="i3" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="i3">i3</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/config/i3/config/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >config</span>
                  </a>
                </li>
            
            <ul>
            
  

            </ul>
          </ul>
        </li>
      </li>
    
  
    
      <li>
        <li>
          <input type="checkbox" id="klavaro" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="klavaro">klavaro</label>
          
          <ul>
              
                <li>
                  <a href="https://budrich.github.io/dots/config/klavaro/preferences/">
                  <span class="glyphicon glyphicon-file"></span><span
                    
                  >preferences</span>
                  </a>
                </li>
            
            <ul>
            
  

            </ul>
          </ul>
        </li>
      </li>
    
  
    
      <li>
        <li>
          <input type="checkbox" id="polybar" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="polybar">polybar</label>
          
          <ul>
              
            <ul>
            
  
    
      <li>
        <li>
          <input type="checkbox" id="src" 
          
            ZgotmplZ
          

          ZgotmplZ
          ZgotmplZ
          ZgotmplZ
          

          />
          
            <label for="src">src</label>
          
          <ul>
              
            <ul>
            
  

            </ul>
          </ul>
        </li>
      </li>
    
  

            </ul>
          </ul>
        </li>
      </li>
    
  

            </ul>
          </ul>
        </li>
      </li>
    
  

            </ul>
          </ul>
        </li>
      </li>
    
  

            <li><a href="https://gitter.im/budRich-github-io/Lobby#"><span class="glyphicon glyphicon-comment"></span>chat</a></li>
            <li><a href="#"><span class="glyphicon glyphicon-star"></span>links</a></li>
            <li><a href="https://github.com/budRich"><span class="glyphicon glyphicon-random"></span>github</a></li>
            <li><a href="#"><span class="glyphicon glyphicon-gift"></span>donate</a></li>
            <li><a href="#"><span class="glyphicon glyphicon-tag"></span>tags</a></li>
            <li><a href="index.xml" type="application/rss+xml" target="_blank"><span class="glyphicon glyphicon-list-alt"></span>rss</a></li>
          </ul>

          
          <div class="postquote">
Curious people are 
interesting people; I 
wonder why that is.
— Bill Maher</div>


          <hr>
          <div class="copynotice">
           <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a> © 2017 - Nils Kvist
          </div>
      </div>
    </div>
  </div>
</div>








<article>
<div class="topblock">
<pre class="lolban">
<span class="ef154"> ██  ████</span><span class="ef148">    </span><span class="ef184">████                          </span>
<span class="ef148">░░ </span><span class="ef184"> █░░░ █  ░██░   ██   ██             </span><span class="ef178">    </span>
<span class="ef184"> ██░    ░█ ██████ ░░██ ██  ██</span><span class="ef178">████</span><span class="ef214">  ██████  </span>
<span class="ef184">░██   ███ ░░░██░   </span><span class="ef178">░░██</span><span class="ef214">█  ░░██░░█ ░░░░░░██ </span>
<span class="ef184">░██  ░░░ </span><span class="ef178">█  ░</span><span class="ef214">██     ░██    ░██ ░   ███████ </span>
<span class="ef178">░██</span><span class="ef214"> █   ░█  ░██     ██     ░██    </span><span class="ef208">██░░░░██ </span>
<span class="ef214">░██░ ████   ░██    ██   </span><span class="ef208">  ░███   ░░████████</span>
<span class="ef214">░░  ░░░░    ░░</span><span class="ef208">    ░░      ░░░     ░░░░░░░░ </span>

</pre>

<h6>Published 11-19-2017 22:20:17</h6></div>

    

<h1 id="an-advanced-simple-tiling-layout-for-i3wm">An advanced simple tiling layout for i3wm</h1>

<p>fyra is the Swedish name for &ldquo;four&rdquo;.</p>


<div style="position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/kU8gb6WLFk8" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" allowfullscreen frameborder="0" title="YouTube Video"></iframe>
 </div>


<p>In the video above I show the functionality of <code>i3fyra</code></p>

<h2 id="dependencies">dependencies</h2>

<ul>
<li><a href="https://budrich.github.io/i3ass/i3list">i3list</a></li>
<li><a href="https://budrich.github.io/i3ass/i3gw">i3gw</a></li>
</ul>

<p>The layout consists of four containers:</p>
<div class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span>A B
C D
</code></pre></div>

<p>The internal layout of the containers doesn&rsquo;t matter.<br />
This means that container A could be tabbed and the others split horizontally for example.</p>

<p>A is always to the right of B and D. And always above C.
B is always to the left of A and C. And always above D.</p>

<p>This means that the containers will change names if their position changes.</p>

<p>The size of the containers are defined by the three splits: AB, AC and BD.
Container A and C are siblings and container B and D are siblings.</p>

<p>If ABC are visible but D is hidden or none existent, layout becomes:</p>
<div class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span>A B
C B
</code></pre></div>

<p>If action: <em>move up</em> (-m u) would be called when B container is active
and D is hidden. Container D would be shown. If action would have been:
<em>move down</em> (-m d), D would be shown and B and D would swap position and name.
If action would have been <em>move left</em> (-m l) the active window in B would be
moved to container A. If action was: <em>move right</em> (-m r) A and C would be hidden:</p>
<div class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span>B B
B B
</code></pre></div>

<p>If we now call action: <em>move left</em> (-m l) A and C would be shown again but
to the right of B, the containers would also change names, so B becomes A,
A becomes B and C becomes D:</p>
<div class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span>A B
A D
</code></pre></div>

<h2 id="usage">usage</h2>

<p><code>i3fyra [OPTTION] [ARGUMENT]</code></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>option | argument | action
--------------------------
-v     |          | Show version info and exit.

-h     |          | Help, shows this info.

-a     |          | Autolayout. If current window is tiled: floating enabled
                    If window is floating, it will be put in a visible container.
                    If there is no visible containers. The window will be placed
                    in a hidden container. If no containers exist, container &#39;A&#39;
                    will be created and the window will be put there.

-s     | A|B|C|D  | Show target container. If it doesn&#39;t exist, it will be 
                    created and current window will be put in it.
                    If it is visible, nothing happens.

-w     | i3list   | Use target i3list instead of getting a new list.

-m     | A|B|C|D  | Moves current window to target container, either defined by
         u|d|l|r    it&#39;s name or it&#39;s position relative to the current container
                    with a direction: [l|left][r|right][u|up][d|down]
                    If the container doesnt exist it is created. If argument is
                    a direction and there is no container in that direction, 
                    Connected container(s) visibility is toggled.
                    If current window is floating or not inside ABCD, normal 
                    movement is performed. Distance for moving floating windows
                    with this action can be defined with the -p option. Example:
                    i3fyra -p 30 -m r
                    Will move current window 30 pixels to the right, 
                    if it is floating.
         
-z     | A|B|C|D  | Hide target container if it is visible, otherwise do nothing.

-f     | u|d|l|r  | move focus in target direction. 

-t     | u|d|l|r  | move focus inside current container (switch tabs). Autowarp.

-p     | INT      | Distance in pixels to move a floating window. Defaults to 30.

-l     | &#39;[AB=INT] [AC=INT] [BD=INT]&#39; | alter splits
                    Changes the given splits. INT is a distance in pixels.
                    AB is on X axis from the left side if INT is positive, from
                       the right side if it is negative.
                    AC and BD is on Y axis from the top if INT is positive, from
                       the bottom if it is negative.
                    The whole argument needs to be quoted. Example:
                    fyra -l &#39;AB=-300 BD=420&#39;
</code></pre></div>

<hr>

<div class="embedfile">




<a href=i3ass/i3fyra/files/i3fyra>i3ass/i3fyra</a>

<div class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span><span class="ch">#!/bin/bash</span>

<span class="nv">NAME</span><span class="o">=</span><span class="s2">&quot;i3fyra&quot;</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="s2">&quot;0.420&quot;</span>
<span class="nv">AUTHOR</span><span class="o">=</span><span class="s2">&quot;budRich&quot;</span>
<span class="nv">CONTACT</span><span class="o">=</span><span class="s1">&#39;robstenklippa@gmail.com&#39;</span>
<span class="nv">CREATED</span><span class="o">=</span><span class="s2">&quot;2017-01-14&quot;</span>
<span class="nv">UPDATED</span><span class="o">=</span><span class="s2">&quot;2017-11-19&quot;</span>

<span class="nv">about</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="nv">$NAME</span><span class="s2"> - </span><span class="nv">$VERSION</span><span class="s2"> - </span><span class="nv">$UPDATED</span><span class="s2"></span>
<span class="s2">created: </span><span class="nv">$CREATED</span><span class="s2"> by </span><span class="nv">$AUTHOR</span><span class="s2"></span>
<span class="s2">===============================</span>
<span class="s2">An advanced simple tiling layout for i3wm. </span>
<span class="s2">The layout consists of four containers:</span>

<span class="s2">  A B</span>
<span class="s2">  C D</span>

<span class="s2">The internal layout of the containers doesn&#39;t matter.</span>

<span class="s2">A is always to the right of B and D. And always above C.</span>
<span class="s2">B is always to the left of A and C. And always above D.</span>

<span class="s2">This means that the containers will change names if their position changes.</span>

<span class="s2">The size of the containers are defined by the three splits: AB, AC and BD.</span>
<span class="s2">Container A and C are siblings and container B and D are siblings. </span>

<span class="s2">If ABC are visible but D is hidden or none existent, layout becomes:</span>

<span class="s2">  A B</span>
<span class="s2">  C B</span>

<span class="s2">If action: *move up* (-m u) would be called when B container is active </span>
<span class="s2">and D is hidden. Container D would be shown. If action would have been:</span>
<span class="s2">*move down* (-m d), D would be shown and B and D would swap position and name.</span>
<span class="s2">If action would have been *move left* (-m l) the active window in B would be</span>
<span class="s2">moved to container A. If action was: *move right* (-m r) A and C would be hidden:</span>

<span class="s2">  B B</span>
<span class="s2">  B B</span>

<span class="s2">If we now call action: *move left* (-m l) A and C would be shown again but</span>
<span class="s2">to the right of B, the containers would also change names, so B becomes A, </span>
<span class="s2">A becomes B and C becomes D:</span>

<span class="s2">  A B</span>
<span class="s2">  A D</span>

<span class="s2">usage</span>
<span class="s2">-----</span>
<span class="nv">$NAME</span><span class="s2"> [OPTTION] [ARGUMENT]</span>

<span class="s2">option | argument | action</span>
<span class="s2">--------------------------</span>
<span class="s2">-v     |          | Show version info and exit.</span>

<span class="s2">-h     |          | Help, shows this info.</span>

<span class="s2">-a     |          | Autolayout. If current window is tiled: floating enabled</span>
<span class="s2">                    If window is floating, it will be put in a visible container.</span>
<span class="s2">                    If there is no visible containers. The window will be placed</span>
<span class="s2">                    in a hidden container. If no containers exist, container &#39;A&#39;</span>
<span class="s2">                    will be created and the window will be put there.</span>

<span class="s2">-s     | A|B|C|D  | Show target container. If it doesn&#39;t exist, it will be </span>
<span class="s2">                    created and current window will be put in it.</span>
<span class="s2">                    If it is visible, nothing happens.</span>

<span class="s2">-w     | i3list   | Use target i3list instead of getting a new list.</span>

<span class="s2">-m     | A|B|C|D  | Moves current window to target container, either defined by</span>
<span class="s2">         u|d|l|r    it&#39;s name or it&#39;s position relative to the current container</span>
<span class="s2">                    with a direction: [l|left][r|right][u|up][d|down]</span>
<span class="s2">                    If the container doesnt exist it is created. If argument is</span>
<span class="s2">                    a direction and there is no container in that direction, </span>
<span class="s2">                    Connected container(s) visibility is toggled.</span>
<span class="s2">                    If current window is floating or not inside ABCD, normal </span>
<span class="s2">                    movement is performed. Distance for moving floating windows</span>
<span class="s2">                    with this action can be defined with the -p option. Example:</span>
<span class="s2">                    i3fyra -p 30 -m r</span>
<span class="s2">                    Will move current window 30 pixels to the right, </span>
<span class="s2">                    if it is floating.</span>
<span class="s2">         </span>
<span class="s2">-z     | A|B|C|D  | Hide target container if it is visible, otherwise do nothing.</span>

<span class="s2">-f     | u|d|l|r  | move focus in target direction. </span>

<span class="s2">-t     | u|d|l|r  | move focus inside current container (switch tabs). Autowarp.</span>

<span class="s2">-p     | INT      | Distance in pixels to move a floating window. Defaults to 30.</span>

<span class="s2">-l     | &#39;[AB=INT] [AC=INT] [BD=INT]&#39; | alter splits</span>
<span class="s2">                    Changes the given splits. INT is a distance in pixels.</span>
<span class="s2">                    AB is on X axis from the left side if INT is positive, from</span>
<span class="s2">                       the right side if it is negative.</span>
<span class="s2">                    AC and BD is on Y axis from the top if INT is positive, from</span>
<span class="s2">                       the bottom if it is negative.</span>
<span class="s2">                    The whole argument needs to be quoted. Example:</span>
<span class="s2">                    fyra -l &#39;AB=-300 BD=420&#39;</span>

<span class="s2">dependencies</span>
<span class="s2">------------</span>

<span class="s2">* i3list</span>
<span class="s2">* i3gw</span>

<span class="s2">contact</span>
<span class="s2">-------</span>
<span class="nv">$CONTACT</span><span class="s2"></span>
<span class="s2">&quot;</span>

initglobals<span class="o">(){</span>

  <span class="nb">local</span> z

  <span class="c1"># alst is the results from i3list placed in an array.</span>

  gla<span class="o">[</span>AWW<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[0]</span><span class="si">}</span>   <span class="c1">#  current workspace</span>
  gla<span class="o">[</span>VIS<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[1]</span><span class="si">}</span>   <span class="c1">#  visible containers</span>
  gla<span class="o">[</span>HID<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[2]</span><span class="si">}</span>   <span class="c1">#  hidden containers</span>
  gla<span class="o">[</span>EXS<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[3]</span><span class="si">}</span>   <span class="c1">#  existing containers (VIS+HID)</span>
  gla<span class="o">[</span>AWP<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[4]</span><span class="si">}</span>   <span class="c1">#  Active window position (b|e|m|g|i)</span>
  gla<span class="o">[</span>AWL<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[5]</span><span class="si">}</span>   <span class="c1">#  Active window layout (t|v|h|s|u)</span>
  gla<span class="o">[</span>AWS<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[6]</span><span class="si">}</span>   <span class="c1">#  Active window status (f|a|n)</span>
  gla<span class="o">[</span>AWC<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[7]</span><span class="si">}</span>   <span class="c1">#  Active window container (A|B|C|D|X)</span>
  gla<span class="o">[</span>AWW<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[8]</span><span class="si">}</span>   <span class="c1">#  Active window workspace</span>
  gla<span class="o">[</span>AWI<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[9]</span><span class="si">}</span>   <span class="c1">#  Active window id (con_id)</span>
  gla<span class="o">[</span>AWM<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[10]</span><span class="si">}</span>  <span class="c1">#  Active window mark</span>
  gla<span class="o">[</span>TWP<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[11]</span><span class="si">}</span>  <span class="c1">#  Target window position (b|e|m|g|i)</span>
  gla<span class="o">[</span>TWL<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[12]</span><span class="si">}</span>  <span class="c1">#  Target window layout (t|v|h|s|u)</span>
  gla<span class="o">[</span>TWS<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[13]</span><span class="si">}</span>  <span class="c1">#  Target window status (f|a|n)</span>
  gla<span class="o">[</span>TWC<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[14]</span><span class="si">}</span>  <span class="c1">#  Target window container (A|B|C|D|X)</span>
  gla<span class="o">[</span>TWW<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[15]</span><span class="si">}</span>  <span class="c1">#  Target window workspace</span>
  gla<span class="o">[</span>TWI<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[16]</span><span class="si">}</span>  <span class="c1">#  Target window id (con_id)</span>
  gla<span class="o">[</span>TWM<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[17]</span><span class="si">}</span>  <span class="c1">#  Target window mark</span>
  gla<span class="o">[</span>LOA<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[18]</span><span class="si">}</span>  <span class="c1">#  Container A layout</span>
  gla<span class="o">[</span>FCA<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[19]</span><span class="si">}</span>  <span class="c1">#  Container A first child (con_id)</span>
  gla<span class="o">[</span>LCA<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[20]</span><span class="si">}</span>  <span class="c1">#  Container A last child (con_id)</span>
  gla<span class="o">[</span>ACA<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[21]</span><span class="si">}</span>  <span class="c1">#  Container A focused child (con_id)</span>
  gla<span class="o">[</span>LOB<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[22]</span><span class="si">}</span>  <span class="c1">#  Container B layout</span>
  gla<span class="o">[</span>FCB<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[23]</span><span class="si">}</span>  <span class="c1">#  Container B first child (con_id)</span>
  gla<span class="o">[</span>LCB<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[24]</span><span class="si">}</span>  <span class="c1">#  Container B last child (con_id)</span>
  gla<span class="o">[</span>ACB<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[25]</span><span class="si">}</span>  <span class="c1">#  Container B focused child (con_id)</span>
  gla<span class="o">[</span>LOC<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[26]</span><span class="si">}</span>  <span class="c1">#  Container C layout</span>
  gla<span class="o">[</span>FCC<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[27]</span><span class="si">}</span>  <span class="c1">#  Container C first child (con_id)</span>
  gla<span class="o">[</span>LCC<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[28]</span><span class="si">}</span>  <span class="c1">#  Container C last child (con_id)</span>
  gla<span class="o">[</span>ACC<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[29]</span><span class="si">}</span>  <span class="c1">#  Container C focused child (con_id)</span>
  gla<span class="o">[</span>LOD<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[30]</span><span class="si">}</span>  <span class="c1">#  Container D layout</span>
  gla<span class="o">[</span>FCD<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[31]</span><span class="si">}</span>  <span class="c1">#  Container D first child (con_id)</span>
  gla<span class="o">[</span>LCD<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[32]</span><span class="si">}</span>  <span class="c1">#  Container D last child (con_id)</span>
  gla<span class="o">[</span>ACD<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[33]</span><span class="si">}</span>  <span class="c1">#  Container D focused child (con_id)</span>
  gla<span class="o">[</span>SAB<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[34]</span><span class="si">}</span>  <span class="c1">#  Stored AB split (mark i34SAB_*)</span>
  gla<span class="o">[</span>SAC<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[35]</span><span class="si">}</span>  <span class="c1">#  Stored AC split (mark i34SAC_*)</span>
  gla<span class="o">[</span>SBD<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[36]</span><span class="si">}</span>  <span class="c1">#  Stored BD split (mark i34SBD_*)</span>
  gla<span class="o">[</span>CAB<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[37]</span><span class="si">}</span>  <span class="c1">#  Current AB split (width of i34XAC)</span>
  gla<span class="o">[</span>CAC<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[38]</span><span class="si">}</span>  <span class="c1">#  Current AC split (height of i34A)</span>
  gla<span class="o">[</span>CBD<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[39]</span><span class="si">}</span>  <span class="c1">#  Current BD split (height of i34B)</span>
  gla<span class="o">[</span>FAC<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[40]</span><span class="si">}</span>  <span class="c1">#  Family AC memory (mark i34FAC_*)</span>
  gla<span class="o">[</span>FBD<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[41]</span><span class="si">}</span>  <span class="c1">#  Family AC memory (mark i34FBD_*)</span>
  gla<span class="o">[</span>SDW<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[42]</span><span class="si">}</span>  <span class="c1">#  Width of current workspace</span>
  gla<span class="o">[</span>SDH<span class="o">]=</span><span class="si">${</span><span class="nv">alst</span><span class="p">[43]</span><span class="si">}</span>  <span class="c1">#  Height of curent workspace</span>

  gla<span class="o">[</span>ALL<span class="o">]=</span>ABCD <span class="c1"># all containers sorted by appearance</span>

  <span class="k">for</span> <span class="o">((</span> <span class="nv">z</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span> z &lt; <span class="m">4</span><span class="p">;</span> z++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
    def<span class="o">[</span><span class="k">$((</span>z+1<span class="k">))</span><span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[ALL]:</span><span class="nv">$z</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="c1"># array with default container positions</span>
    loa<span class="o">[</span><span class="k">$((</span>z+1<span class="k">))</span><span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[ALL]:</span><span class="nv">$z</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="c1"># array with actual container positions</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWC]</span><span class="si">}</span> <span class="o">=</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[ALL]:</span><span class="nv">$z</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">ncur</span><span class="o">=</span><span class="k">$((</span>z+1<span class="k">))</span> <span class="c1"># theoretic position of active container</span>
  <span class="k">done</span>

  gla<span class="o">[</span>ALL<span class="o">]=</span>ACBD <span class="c1"># all containers sorted by families</span>
<span class="o">}</span>

applysplits<span class="o">(){</span>
  <span class="nb">local</span> i tsn tsv osv par dir tsp osp dirv csp mrk ssv
  <span class="nv">asplt</span><span class="o">=(</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="o">)</span>
  <span class="k">for</span> i in <span class="si">${</span><span class="p">!asplt[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
    <span class="nv">tsn</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">asplt</span><span class="p">[</span><span class="nv">$i</span><span class="p">]%</span><span class="se">\=</span><span class="p">*</span><span class="si">}</span><span class="s2">&quot;</span> <span class="c1"># target name of split</span>
    <span class="nv">tsv</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">asplt</span><span class="p">[</span><span class="nv">$i</span><span class="p">]#*</span><span class="se">\=</span><span class="si">}</span><span class="s2">&quot;</span> <span class="c1"># target value of split</span>
    <span class="nv">osv</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tsn</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># current value of split</span>
    <span class="nv">ssv</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">gla</span><span class="p">[S</span><span class="si">${</span><span class="nv">tsn</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># stored value of split</span>

    <span class="o">[[</span> <span class="nv">$tsn</span> <span class="o">=</span> AB <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">par</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span> <span class="nv">dir</span><span class="o">=</span>width <span class="nv">mrk</span><span class="o">=</span>i34XAC <span class="se">\</span>
                    <span class="o">||</span> <span class="nv">par</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span> <span class="nv">dir</span><span class="o">=</span>height <span class="nv">mrk</span><span class="o">=</span>i34<span class="si">${</span><span class="nv">tsn</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>

    <span class="o">((</span>tsv&lt;<span class="m">0</span><span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="nv">tsv</span><span class="o">=</span><span class="k">$((</span>tsv*-1<span class="k">))</span> <span class="nv">tsv</span><span class="o">=</span><span class="k">$((</span>par-tsv<span class="k">))</span>
    <span class="nv">tsp</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$tsv</span> <span class="nv">$par</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1/$2*100 }&#39;</span><span class="k">)</span>
    <span class="nv">osp</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$osv</span> <span class="nv">$par</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1/$2*100 }&#39;</span><span class="k">)</span>
    <span class="nv">tsp</span><span class="o">=</span><span class="si">${</span><span class="nv">tsp</span><span class="p">%.*</span><span class="si">}</span> <span class="nv">osp</span><span class="o">=</span><span class="si">${</span><span class="nv">osp</span><span class="p">%.*</span><span class="si">}</span>

    <span class="o">((</span><span class="nv">tsp</span><span class="o">==</span>osp<span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="k">continue</span>
    <span class="o">((</span>tsp&gt;osp<span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="nv">dirv</span><span class="o">=</span>grow <span class="nv">csp</span><span class="o">=</span><span class="k">$((</span>tsp-osp<span class="k">))</span> <span class="se">\</span>
                <span class="o">||</span> <span class="nv">dirv</span><span class="o">=</span>shrink <span class="nv">csp</span><span class="o">=</span><span class="k">$((</span>osp-tsp<span class="k">))</span>

    i3-msg -q <span class="s2">&quot;[con_mark=</span><span class="nv">$mrk</span><span class="s2">]&quot;</span> <span class="se">\</span>
      resize <span class="nv">$dirv</span> <span class="nv">$dir</span> <span class="nv">$csp</span> px or <span class="nv">$csp</span> ppt

    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$ssv</span> <span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      i3gw <span class="s2">&quot;i34S</span><span class="si">${</span><span class="nv">tsn</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">tsv</span><span class="si">}</span><span class="s2">&quot;</span>  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34S</span><span class="si">${</span><span class="nv">tsn</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">tsv</span><span class="si">}</span><span class="s2">]&quot;</span> move scratchpad
    <span class="k">else</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34S</span><span class="si">${</span><span class="nv">tsn</span><span class="si">}</span><span class="s2">]&quot;</span> mark <span class="s2">&quot;i34S</span><span class="si">${</span><span class="nv">tsn</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">tsv</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">fi</span>
  <span class="k">done</span>
<span class="o">}</span>

tabswitch<span class="o">(){</span>
  <span class="nb">local</span> dir ldir

  <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWC]</span><span class="si">}</span> <span class="o">=</span> X <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> o <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="k">return</span>

  <span class="nv">dir</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">r</span><span class="si">}</span>
  <span class="nv">dir</span><span class="o">=</span><span class="si">${</span><span class="nv">dir</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>

  <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span>~ v<span class="p">|</span>s <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">dir</span><span class="o">=</span><span class="si">${</span><span class="nv">dir</span><span class="p">/l/u</span><span class="si">}</span> <span class="nv">dir</span><span class="o">=</span><span class="si">${</span><span class="nv">dir</span><span class="p">/r/d</span><span class="si">}</span>

  <span class="k">case</span> <span class="nv">$dir</span> in
    l <span class="o">)</span> <span class="nv">ldir</span><span class="o">=</span>left  <span class="p">;;</span>
    r <span class="o">)</span> <span class="nv">ldir</span><span class="o">=</span>right <span class="p">;;</span>
    u <span class="o">)</span> <span class="nv">ldir</span><span class="o">=</span>up    <span class="p">;;</span>
    d <span class="o">)</span> <span class="nv">ldir</span><span class="o">=</span>down  <span class="p">;;</span>
  <span class="k">esac</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> e <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span>~ r<span class="p">|</span>d <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[FC</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWC]</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> focus
    <span class="c1">#statements</span>
  <span class="k">elif</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> b <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span>~ l<span class="p">|</span>u <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[LC</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWC]</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> focus
    <span class="c1">#statements</span>
  <span class="k">else</span>
    i3-msg -q focus <span class="nv">$ldir</span>
  <span class="k">fi</span>
<span class="o">}</span>

windowfocus<span class="o">(){</span>
  
  <span class="nb">local</span> cur dir trg sib twin cous ldir
  <span class="nb">local</span> awp awl shd normove trgid

  <span class="nv">cur</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWC]</span><span class="si">}</span>

  <span class="nv">dir</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">r</span><span class="si">}</span>
  <span class="nv">shd</span><span class="o">=</span><span class="si">${</span><span class="nv">dir</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>  <span class="c1"># first letter in direction</span>

  <span class="k">case</span> <span class="nv">$shd</span> in
    l <span class="o">)</span> <span class="nv">ldir</span><span class="o">=</span>left  <span class="p">;;</span>
    r <span class="o">)</span> <span class="nv">ldir</span><span class="o">=</span>right <span class="p">;;</span>
    u <span class="o">)</span> <span class="nv">ldir</span><span class="o">=</span>up    <span class="p">;;</span>
    d <span class="o">)</span> <span class="nv">ldir</span><span class="o">=</span>down  <span class="p">;;</span>
  <span class="k">esac</span>

  <span class="nv">normove</span><span class="o">=</span><span class="m">0</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span>~ A<span class="p">|</span>B<span class="p">|</span>C<span class="p">|</span>D <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[EXS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      containershow <span class="nv">$dir</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">]&quot;</span> focus
    <span class="k">fi</span>
    <span class="k">return</span>
  <span class="k">fi</span>

  <span class="nb">echo</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span>

  <span class="c1"># normal movement if:</span>
  <span class="k">while</span> :<span class="p">;</span><span class="k">do</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> h <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> m <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span>~ <span class="o">[</span>lr<span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> k1 <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> h <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> b <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> r <span class="o">]]</span>  <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> k2 <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> h <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> e <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> l <span class="o">]]</span>  <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> k3 <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> v <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> m <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span>~ u<span class="p">|</span>d <span class="o">]]</span> <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> k4 <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> v <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> b <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> d <span class="o">]]</span>  <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> k5 <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> v <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> e <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> u <span class="o">]]</span>  <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> k6 <span class="o">&amp;&amp;</span> <span class="nb">break</span>

    <span class="nb">break</span>
  <span class="k">done</span>

  <span class="c1"># if window isn&#39;t handled by i34, move it normaly</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$cur</span> <span class="o">=</span> X <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="nv">$normove</span> <span class="o">=</span> <span class="m">1</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="o">[[</span> ! <span class="nv">$shd</span> <span class="o">=</span>~ l<span class="p">|</span>r<span class="p">|</span>u<span class="p">|</span>d <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="k">return</span>
    i3-msg -q focus <span class="nv">$ldir</span> <span class="o">&amp;&amp;</span> <span class="k">return</span>
  <span class="k">fi</span>

  <span class="c1"># if window is the only visible window handled by i34, do nothing</span>
  <span class="o">((</span><span class="si">${#</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">==</span><span class="m">1</span><span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="k">return</span>

  <span class="k">case</span> <span class="nv">$cur</span> in
    A <span class="o">)</span> <span class="nv">twin</span><span class="o">=</span>B <span class="nv">cous</span><span class="o">=</span>D <span class="nv">sib</span><span class="o">=</span>C <span class="p">;;</span>
    B <span class="o">)</span> <span class="nv">twin</span><span class="o">=</span>A <span class="nv">cous</span><span class="o">=</span>C <span class="nv">sib</span><span class="o">=</span>D <span class="p">;;</span>
    C <span class="o">)</span> <span class="nv">twin</span><span class="o">=</span>D <span class="nv">cous</span><span class="o">=</span>B <span class="nv">sib</span><span class="o">=</span>A <span class="p">;;</span>
    D <span class="o">)</span> <span class="nv">twin</span><span class="o">=</span>C <span class="nv">cous</span><span class="o">=</span>A <span class="nv">sib</span><span class="o">=</span>B <span class="p">;;</span>
  <span class="k">esac</span>

  <span class="nv">trg</span><span class="o">=</span>X

  <span class="c1"># if up down, focus sib if it is visible</span>
  <span class="k">if</span>   <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> u <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$sib</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[LO</span><span class="si">${</span><span class="nv">sib</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> <span class="o">=</span> v <span class="o">]]</span> <span class="o">&amp;&amp;</span> i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[LC</span><span class="si">${</span><span class="nv">sib</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> focus <span class="se">\</span>
                               <span class="o">||</span> i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AC</span><span class="si">${</span><span class="nv">sib</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> focus
  <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> d <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$sib</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[LO</span><span class="si">${</span><span class="nv">sib</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> <span class="o">=</span> v <span class="o">]]</span> <span class="o">&amp;&amp;</span> i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[FC</span><span class="si">${</span><span class="nv">sib</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> focus <span class="se">\</span>
                               <span class="o">||</span> i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AC</span><span class="si">${</span><span class="nv">sib</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> focus

  <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span>~ l<span class="p">|</span>r <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>

    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$twin</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">trg</span><span class="o">=</span><span class="nv">$twin</span>
    <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$cous</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">trg</span><span class="o">=</span><span class="nv">$cous</span>
    <span class="k">fi</span>

    <span class="o">[[</span> <span class="nv">$trg</span> <span class="o">=</span> X <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="k">return</span>

    <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[LO</span><span class="nv">$trg</span><span class="p">]</span><span class="si">}</span> !<span class="o">=</span> h <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">trgid</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AC</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="p">]</span><span class="si">}</span>
    <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> l <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">trgid</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[LC</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> 
    <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> r <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">trgid</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[FC</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="p">]</span><span class="si">}</span>
    <span class="k">fi</span> 
    i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">trgid</span><span class="si">}</span><span class="s2">]&quot;</span> focus
  <span class="k">fi</span>
<span class="o">}</span>

windowmove<span class="o">(){</span>

  <span class="nb">local</span> cur dir wall trg sib twin cous i xofam
  <span class="nb">local</span> tfam ofam ntrg trg i34W lstcnts exst tfammem
  <span class="nb">local</span> shd normove
  <span class="nv">cur</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWC]</span><span class="si">}</span>
  <span class="nv">dir</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nv">normove</span><span class="o">=</span><span class="m">0</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span>~ A<span class="p">|</span>B<span class="p">|</span>C<span class="p">|</span>D <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      containershow <span class="nv">$dir</span>
      i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWI]</span><span class="si">}</span><span class="s2">]&quot;</span> floating disable, move to mark i34<span class="si">${</span><span class="nv">dir</span><span class="si">}</span>
    <span class="k">else</span>
      containershow <span class="nv">$dir</span>
    <span class="k">fi</span>
    i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWI]</span><span class="si">}</span><span class="s2">]&quot;</span> focus
    <span class="k">return</span>
  <span class="k">fi</span>

  <span class="nv">shd</span><span class="o">=</span><span class="si">${</span><span class="nv">dir</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>  <span class="c1"># first letter in direction</span>

  <span class="c1"># normal movement if:</span>
  <span class="k">while</span> :<span class="p">;</span><span class="k">do</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> h <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> m <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span>~ <span class="o">[</span>lr<span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> h <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> b <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> r <span class="o">]]</span>  <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> h <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> e <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> l <span class="o">]]</span>  <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> v <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> m <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span>~ <span class="o">[</span>ud<span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> v <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> b <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> d <span class="o">]]</span>  <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWL]</span><span class="si">}</span> <span class="o">=</span> v <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> e <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$shd</span> <span class="o">=</span> u <span class="o">]]</span>  <span class="se">\</span>
      <span class="o">&amp;&amp;</span> <span class="nv">normove</span><span class="o">=</span><span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>

    <span class="nb">break</span>
  <span class="k">done</span>

  <span class="c1"># if window isn&#39;t handled by i34, move it normaly</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$cur</span> <span class="o">=</span> X <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="nv">$normove</span> <span class="o">=</span> <span class="m">1</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="o">[[</span> ! <span class="si">${</span><span class="nv">dir</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">=</span>~ l<span class="p">|</span>r<span class="p">|</span>u<span class="p">|</span>d <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="k">return</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="si">${#</span><span class="nv">dir</span><span class="si">}</span> <span class="o">=</span> <span class="m">1</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="k">case</span> <span class="nv">$dir</span> in
        l <span class="o">)</span> <span class="nv">dir</span><span class="o">=</span>left  <span class="p">;;</span>
        r <span class="o">)</span> <span class="nv">dir</span><span class="o">=</span>right <span class="p">;;</span>
        u <span class="o">)</span> <span class="nv">dir</span><span class="o">=</span>up    <span class="p">;;</span>
        d <span class="o">)</span> <span class="nv">dir</span><span class="o">=</span>down  <span class="p">;;</span>
      <span class="k">esac</span>
    <span class="k">fi</span>

    <span class="c1"># speed can be set with -p option</span>
    <span class="nv">speed</span><span class="o">=</span><span class="si">${</span><span class="nv">speed</span><span class="k">:-</span><span class="nv">10</span><span class="si">}</span>
    i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWI]</span><span class="si">}</span><span class="s2">]&quot;</span> move <span class="nv">$dir</span> <span class="nv">$speed</span>

    <span class="k">return</span>
  <span class="k">fi</span>

  <span class="nv">exst</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span>
  <span class="nv">exst</span><span class="o">=</span><span class="si">${</span><span class="nv">exst</span><span class="p">//X/</span><span class="si">}</span>

  <span class="c1"># if window is the only window handled by i34, do nothing</span>
  <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> o <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">((</span><span class="si">${#</span><span class="nv">exst</span><span class="si">}</span><span class="o">==</span><span class="m">1</span><span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="k">return</span>

  <span class="k">case</span> <span class="nv">$cur</span> in
    A <span class="o">)</span> <span class="nv">twin</span><span class="o">=</span>B <span class="nv">cous</span><span class="o">=</span>D <span class="nv">sib</span><span class="o">=</span>C <span class="nv">tfam</span><span class="o">=</span>AC <span class="nv">ofam</span><span class="o">=</span>BD <span class="p">;;</span>
    B <span class="o">)</span> <span class="nv">twin</span><span class="o">=</span>A <span class="nv">cous</span><span class="o">=</span>C <span class="nv">sib</span><span class="o">=</span>D <span class="nv">tfam</span><span class="o">=</span>BD <span class="nv">ofam</span><span class="o">=</span>AC <span class="p">;;</span>
    C <span class="o">)</span> <span class="nv">twin</span><span class="o">=</span>D <span class="nv">cous</span><span class="o">=</span>B <span class="nv">sib</span><span class="o">=</span>A <span class="nv">tfam</span><span class="o">=</span>AC <span class="nv">ofam</span><span class="o">=</span>BD <span class="p">;;</span>
    D <span class="o">)</span> <span class="nv">twin</span><span class="o">=</span>C <span class="nv">cous</span><span class="o">=</span>A <span class="nv">sib</span><span class="o">=</span>B <span class="nv">tfam</span><span class="o">=</span>BD <span class="nv">ofam</span><span class="o">=</span>AC <span class="p">;;</span>
  <span class="k">esac</span>

  <span class="nb">declare</span> -A dv

  dv<span class="o">[</span>l<span class="o">]=</span><span class="s2">&quot;-1&quot;</span>
  dv<span class="o">[</span>r<span class="o">]=</span><span class="s2">&quot;1&quot;</span>
  dv<span class="o">[</span>u<span class="o">]=</span><span class="s2">&quot;-2&quot;</span>
  dv<span class="o">[</span>d<span class="o">]=</span><span class="s2">&quot;2&quot;</span>

  <span class="nv">wall</span><span class="o">=</span><span class="m">0</span>

  <span class="nv">ntrg</span><span class="o">=</span><span class="k">$((</span>ncur+<span class="si">${</span><span class="nv">dv</span><span class="p">[</span><span class="si">${</span><span class="nv">dir</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="k">))</span>

  <span class="o">[[</span> <span class="nv">$ncur</span> <span class="o">=</span> <span class="m">2</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">dir</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">=</span> r <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">ntrg</span><span class="o">=</span><span class="m">5</span>
  <span class="o">[[</span> <span class="nv">$ncur</span> <span class="o">=</span> <span class="m">3</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">dir</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">=</span> l <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">ntrg</span><span class="o">=</span><span class="m">0</span>

  <span class="nv">ntrg</span><span class="o">=</span><span class="k">$((</span>ntrg&lt;<span class="m">1</span>?0:ntrg<span class="k">))</span>
  <span class="o">[[</span> ! <span class="nv">$ntrg</span> <span class="o">=</span>~ <span class="o">[</span><span class="m">1</span>-4<span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
  <span class="o">||</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">loa</span><span class="p">[</span><span class="nv">$ntrg</span><span class="p">]</span><span class="si">}</span> <span class="o">=</span> <span class="si">${</span><span class="nv">loa</span><span class="p">[</span><span class="nv">$ncur</span><span class="p">]</span><span class="si">}</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">wall</span><span class="o">=</span><span class="m">1</span>

  <span class="k">if</span> <span class="o">((</span><span class="nv">wall</span><span class="o">==</span><span class="m">1</span><span class="o">))</span><span class="p">;</span> <span class="k">then</span>
    <span class="c1"># if cur is only existing and active is only child, return</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span>~ u<span class="p">|</span>d <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="c1"># sibling action</span>
      <span class="k">if</span> <span class="o">[[</span> <span class="nv">$sib</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
        <span class="c1"># hide sibling</span>
        containerhide <span class="nv">$sib</span>
      <span class="k">else</span>
        <span class="c1"># show sibling</span>

        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$sib</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
        <span class="c1"># show hidden sibbling</span>
        containershow <span class="nv">$sib</span>
        <span class="nv">trg</span><span class="o">=</span><span class="nv">$sib</span>
        <span class="k">else</span>
          <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> !<span class="o">=</span> o <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
            containerrename <span class="nv">$cur</span> <span class="nv">$sib</span>
            containershow <span class="nv">$cur</span>
            <span class="nb">echo</span> <span class="s2">&quot;case 4&quot;</span>
          <span class="k">else</span>
            <span class="c1"># get number of existing ofams:</span>
            <span class="k">for</span> <span class="o">((</span> <span class="nv">i</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span> i &lt; <span class="m">2</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
              <span class="o">[[</span> <span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">xofam</span><span class="o">+=</span><span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
            <span class="k">done</span>

            <span class="k">if</span> <span class="o">((</span><span class="si">${#</span><span class="nv">xofam</span><span class="si">}</span><span class="o">==</span><span class="m">2</span><span class="o">))</span><span class="p">;</span> <span class="k">then</span>

              <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">awop</span><span class="p">:</span><span class="nv">2</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">=</span> o <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> <span class="c1"># only child</span>
                <span class="k">for</span> <span class="o">((</span> <span class="nv">i</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span> i &lt; <span class="m">2</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
                  containershow <span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
                <span class="k">done</span>
                <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span> u <span class="o">]]</span> <span class="se">\</span>
                  <span class="o">&amp;&amp;</span> i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWI]</span><span class="si">}</span><span class="s2">]&quot;</span> move to mark i34<span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="se">\</span>
                  <span class="o">||</span> i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWI]</span><span class="si">}</span><span class="s2">]&quot;</span> move to mark i34<span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">1</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
                <span class="nv">cur</span><span class="o">=</span>NOSWAP
              <span class="k">else</span>
              <span class="c1"># rename cur -&gt; sib, move act to cur</span>
                containerrename <span class="nv">$cur</span> <span class="nv">$sib</span>
                containershow <span class="nv">$cur</span>
                <span class="nv">trg</span><span class="o">=</span><span class="nv">$sib</span>
              <span class="k">fi</span>

            <span class="k">elif</span> <span class="o">((</span><span class="si">${#</span><span class="nv">xofam</span><span class="si">}</span><span class="o">==</span><span class="m">1</span><span class="o">))</span><span class="p">;</span> <span class="k">then</span>
              <span class="c1"># rename existing ofam cousin and show it</span>
              <span class="o">[[</span> <span class="nv">$xofam</span> !<span class="o">=</span> <span class="nv">$cous</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> containerrename <span class="nv">$xofam</span> <span class="nv">$cous</span>
              containershow <span class="nv">$cous</span>
              <span class="c1"># rename cur -&gt; twin, hide show, cur=twin trg=cous</span>
              containerrename <span class="nv">$cur</span> <span class="nv">$twin</span>
              containerhide <span class="nv">$twin</span>
              containershow <span class="nv">$twin</span>
              <span class="nv">trg</span><span class="o">=</span><span class="nv">$cous</span> <span class="nv">cur</span><span class="o">=</span><span class="nv">$twin</span>
              <span class="nb">echo</span> <span class="s2">&quot;case 3&quot;</span>
            
            <span class="k">fi</span>
          <span class="k">fi</span>
        <span class="k">fi</span>
        <span class="c1"># swapcheck</span>
        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$cur</span> !<span class="o">=</span> NOSWAP <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
          <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span> u <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">((</span>ncur&gt;2<span class="o">))</span> <span class="se">\</span>
            <span class="o">&amp;&amp;</span> swapmeet <span class="s2">&quot;i34</span><span class="si">${</span><span class="nv">cur</span><span class="si">}</span><span class="s2">&quot;</span> <span class="s2">&quot;i34</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">&quot;</span>
          <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span> d <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">((</span>ncur&lt;<span class="m">3</span><span class="o">))</span> <span class="se">\</span>
            <span class="o">&amp;&amp;</span> swapmeet <span class="s2">&quot;i34</span><span class="si">${</span><span class="nv">cur</span><span class="si">}</span><span class="s2">&quot;</span> <span class="s2">&quot;i34</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">fi</span>
      <span class="k">fi</span>
    <span class="k">else</span>
      <span class="c1"># family action</span>

      <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">loa</span><span class="p">[1]</span><span class="si">}</span> !<span class="o">=</span> <span class="si">${</span><span class="nv">loa</span><span class="p">[2]</span><span class="si">}</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
        familyhide <span class="nv">$ofam</span>
      <span class="k">else</span>
        <span class="c1"># show opfam</span>

        <span class="o">[[</span> <span class="nv">$ofam</span> <span class="o">=</span> AC <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">tfammem</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[FAC]</span><span class="si">}</span> <span class="o">||</span> <span class="nv">tfammem</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[FBD]</span><span class="si">}</span>

        <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">tfammem</span><span class="si">}</span> !<span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> 
          <span class="c1"># show last opfam</span>
          <span class="k">for</span> <span class="o">((</span> <span class="nv">i</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span> i &lt; <span class="si">${#</span><span class="nv">tfammem</span><span class="si">}</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
            <span class="o">[[</span> <span class="si">${</span><span class="nv">tfammem</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
              <span class="o">&amp;&amp;</span> containershow <span class="si">${</span><span class="nv">tfammem</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">&amp;&amp;</span> <span class="nv">i34W</span><span class="o">+=</span><span class="si">${</span><span class="nv">tfammem</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> prio1
          <span class="k">done</span>
        <span class="k">fi</span>

        <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">tfammem</span><span class="si">}</span> <span class="o">=</span> X <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> -z <span class="si">${</span><span class="nv">i34W</span><span class="si">}</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
          <span class="c1"># show hidden opfam not in last</span>
          <span class="k">for</span> <span class="o">((</span> <span class="nv">i</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span> i &lt; <span class="m">2</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
            <span class="o">[[</span> <span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
              <span class="o">&amp;&amp;</span> containershow <span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">&amp;&amp;</span> <span class="nv">i34W</span><span class="o">+=</span><span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> prio2
          <span class="k">done</span>
        <span class="k">fi</span>

        <span class="k">if</span> <span class="o">[[</span> -z <span class="si">${</span><span class="nv">i34W</span><span class="si">}</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="nv">$sib</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
          <span class="c1"># rename sib if it exist -&gt; ${ofam:0:1} hide and show</span>
          containerrename <span class="nv">$sib</span> <span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
          <span class="o">[[</span> <span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> containerhide <span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
          containershow <span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
          <span class="nb">echo</span> <span class="s2">&quot;renaming </span><span class="nv">$sib</span><span class="s2"> -&gt; </span><span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>
          <span class="nb">echo</span> prio3
        <span class="k">elif</span> <span class="o">[[</span> -z <span class="si">${</span><span class="nv">i34W</span><span class="si">}</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
          <span class="c1"># rename cur ${ofam:0:1} hide and show, create cur from act</span>
          containerrename <span class="nv">$cur</span> <span class="si">${</span><span class="nv">ofam</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
          containershow <span class="nv">$cur</span>
          <span class="nb">echo</span> prio4
        <span class="k">fi</span>

        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$dir</span><span class="s2"> nc:</span><span class="nv">$ncur</span><span class="s2"> %:</span><span class="k">$((</span>ncur%2<span class="k">))</span><span class="s2">&quot;</span>
        <span class="c1"># swapcheck</span>
        <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span> r <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="k">$((</span>ncur%2<span class="k">))</span> -eq <span class="m">1</span> <span class="o">]]</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> swapmeet <span class="s2">&quot;i34X</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">&quot;</span> <span class="s2">&quot;i34X</span><span class="si">${</span><span class="nv">ofam</span><span class="si">}</span><span class="s2">&quot;</span> 
        <span class="o">[[</span> <span class="nv">$dir</span> <span class="o">=</span> l <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="k">$((</span>ncur%2<span class="k">))</span> -eq <span class="m">0</span> <span class="o">]]</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> swapmeet <span class="s2">&quot;i34X</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">&quot;</span> <span class="s2">&quot;i34X</span><span class="si">${</span><span class="nv">ofam</span><span class="si">}</span><span class="s2">&quot;</span>
      <span class="k">fi</span>
    <span class="k">fi</span>
  <span class="k">else</span>
    i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWI]</span><span class="si">}</span><span class="s2">]&quot;</span> move to mark <span class="s2">&quot;i34</span><span class="si">${</span><span class="nv">loa</span><span class="p">[</span><span class="nv">$ntrg</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">fi</span>
  i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWI]</span><span class="si">}</span><span class="s2">]&quot;</span> focus
<span class="o">}</span>

familyhide<span class="o">(){</span>
  <span class="nb">local</span> <span class="nv">tfam</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nb">local</span> trg famchk tfammem fammrk

  <span class="k">for</span> <span class="o">((</span> <span class="nv">i</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span> i &lt; <span class="m">2</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
    <span class="nv">trg</span><span class="o">=</span><span class="si">${</span><span class="nv">tfam</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">trg</span><span class="si">}</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nb">echo</span> <span class="s2">&quot;</span><span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span><span class="k">))</span><span class="s2">&quot;</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">]&quot;</span> focus, floating enable, <span class="se">\</span>
        move absolute position <span class="m">0</span> px <span class="m">0</span> px, <span class="se">\</span>
        resize <span class="nb">set</span> <span class="s2">&quot;</span><span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span><span class="s2">&quot;</span> px <span class="s2">&quot;</span><span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span><span class="s2">&quot;</span> px, <span class="se">\</span>
        move scratchpad
      <span class="c1"># add to trg to hid</span>
      gla<span class="o">[</span>HID<span class="o">]</span>+<span class="o">=</span><span class="nv">$trg</span>
      gla<span class="o">[</span>VIS<span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]/</span><span class="nv">$trg</span><span class="p">/</span><span class="si">}</span>
      gla<span class="o">[</span>VIS<span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="k">:-</span><span class="nv">X</span><span class="si">}</span>
      <span class="nv">famchk</span><span class="o">+=</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span>
    <span class="k">fi</span>
    <span class="nb">echo</span> <span class="s2">&quot;hiding fam </span><span class="nv">$trg</span><span class="s2"> --- </span><span class="nv">$tfam</span><span class="s2">&quot;</span>
  <span class="k">done</span>
  <span class="c1"># get infomark</span>

  <span class="nv">fammrk</span><span class="o">=</span><span class="s2">&quot;i34F</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_&quot;</span>
  <span class="c1"># update/create info mark</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[F</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> <span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    i3gw <span class="s2">&quot;</span><span class="si">${</span><span class="nv">fammrk</span><span class="si">}${</span><span class="nv">famchk</span><span class="si">}</span><span class="s2">&quot;</span>  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
    i3-msg -q <span class="s2">&quot;[con_mark=</span><span class="si">${</span><span class="nv">fammrk</span><span class="si">}${</span><span class="nv">famchk</span><span class="si">}</span><span class="s2">]&quot;</span> move scratchpad
  <span class="k">else</span>
    i3-msg -q <span class="s2">&quot;[con_mark=</span><span class="si">${</span><span class="nv">fammrk</span><span class="si">}${</span><span class="nv">fammem</span><span class="si">}</span><span class="s2">]&quot;</span> mark <span class="s2">&quot;</span><span class="si">${</span><span class="nv">fammrk</span><span class="si">}${</span><span class="nv">famchk</span><span class="si">}</span><span class="s2">]&quot;</span>
  <span class="k">fi</span>

  <span class="c1"># note splits</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span> !<span class="o">=</span> X <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span> -ne <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span><span class="k">))</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span> -ne <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[SAB]</span><span class="si">}</span> <span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      i3gw <span class="s2">&quot;i34SAB_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span><span class="s2">&quot;</span>  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34SAB_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span><span class="s2">]&quot;</span> move scratchpad
    <span class="k">else</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34SAB_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SAB]</span><span class="si">}</span><span class="s2">]&quot;</span> mark <span class="s2">&quot;i34SAB_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">fi</span>
    gla<span class="o">[</span>SAB<span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span>
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> !<span class="o">=</span> X <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> -ne <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span><span class="k">))</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> -ne <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> <span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      i3gw <span class="s2">&quot;i34S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> move scratchpad
    <span class="k">else</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> mark <span class="s2">&quot;i34S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">fi</span>
    gla<span class="o">[</span>S<span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span>
  <span class="k">fi</span>

  dothelo
<span class="o">}</span>

familycreate<span class="o">(){</span>
  <span class="nb">local</span> trg tfam
  <span class="nv">trg</span><span class="o">=</span><span class="nv">$1</span>

  <span class="o">[[</span> <span class="nv">$trg</span> <span class="o">=</span>~ A<span class="p">|</span>C <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">tfam</span><span class="o">=</span>AC <span class="o">||</span> <span class="nv">tfam</span><span class="o">=</span>BD

  i3-msg -q <span class="s2">&quot;[con_mark=i34X</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">]&quot;</span> unmark
  i3gw gurra  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> move to mark i34XAB, split v, layout tabbed

  i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">]&quot;</span> move to workspace <span class="si">${</span><span class="nv">gla</span><span class="p">[AWW]</span><span class="si">}</span>, <span class="se">\</span>
    floating disable, <span class="se">\</span>
    move to mark gurra
  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> focus, focus parent
  i3-msg -q mark i34X<span class="si">${</span><span class="nv">tfam</span><span class="si">}</span>
  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> layout default, split v
  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> <span class="nb">kill</span>
  i3-msg -q <span class="s2">&quot;[con_mark=i34X</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">]&quot;</span> layout splitv, split v
  i3-msg -q <span class="s2">&quot;[con_mark=i34XAB]&quot;</span> layout splith, split h
<span class="o">}</span>

layoutcreate<span class="o">(){</span>
  <span class="nb">local</span> trg fam

  <span class="nv">trg</span><span class="o">=</span><span class="nv">$1</span>
  <span class="o">[[</span> <span class="nv">$trg</span> <span class="o">=</span>~ A<span class="p">|</span>C <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">fam</span><span class="o">=</span>AC <span class="o">||</span> <span class="nv">fam</span><span class="o">=</span>BD

  i3-msg -q <span class="s2">&quot;[con_mark=i34XAB]&quot;</span> unmark
  i3gw gurra  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> split v, layout tabbed, focus parent
  i3-msg -q mark i34X<span class="si">${</span><span class="nv">fam</span><span class="si">}</span>, focus parent
  i3-msg -q mark i34XAB


  i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">]&quot;</span> move to workspace <span class="si">${</span><span class="nv">gla</span><span class="p">[AWW]</span><span class="si">}</span>, <span class="se">\</span>
    floating disable, <span class="se">\</span>
    move to mark gurra
  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> layout default, split h

  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> <span class="nb">kill</span>
  i3-msg -q <span class="s2">&quot;[con_mark=i34X</span><span class="si">${</span><span class="nv">fam</span><span class="si">}</span><span class="s2">]&quot;</span> layout splitv, split v
  i3-msg -q <span class="s2">&quot;[con_mark=i34XAB]&quot;</span> layout splith, split h
<span class="o">}</span>

containershow<span class="o">(){</span>
  <span class="nb">local</span> trg sts k tpos tdest tfam
  <span class="nb">local</span> tsplit tperc sperc sdir
  <span class="nv">trg</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nv">sts</span><span class="o">=</span>none

  <span class="o">[[</span> <span class="nv">$trg</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">sts</span><span class="o">=</span>visible
  <span class="o">[[</span> <span class="nv">$trg</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">sts</span><span class="o">=</span>hidden

  <span class="k">case</span> <span class="nv">$sts</span> in
    visible <span class="o">)</span> <span class="k">return</span> <span class="p">;;</span>
    none    <span class="o">)</span> containercreate <span class="nv">$trg</span> <span class="p">;;</span>
    hidden  <span class="o">)</span>
      <span class="c1"># tfam=family for target</span>
      <span class="o">[[</span> <span class="nv">$trg</span> <span class="o">=</span>~ A<span class="p">|</span>C <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">tfam</span><span class="o">=</span>AC <span class="o">||</span> <span class="nv">tfam</span><span class="o">=</span>BD
      <span class="c1"># tpos=theoratical position (1-4) for target</span>
      <span class="k">for</span> k in <span class="si">${</span><span class="p">!def[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
        <span class="o">[[</span> <span class="si">${</span><span class="nv">def</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="si">}</span> <span class="o">=</span> <span class="nv">$trg</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">tpos</span><span class="o">=</span><span class="nv">$k</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
      <span class="k">done</span>

      <span class="c1"># ocnt=container currently occupying tpos</span>
      <span class="nv">ocnt</span><span class="o">=</span><span class="si">${</span><span class="nv">loa</span><span class="p">[</span><span class="nv">$tpos</span><span class="p">]</span><span class="si">}</span>
      <span class="c1"># if ocnt is family, move trg to famcont</span>
      <span class="c1"># tdest= target destination</span>
      <span class="o">[[</span> <span class="nv">$ocnt</span> <span class="o">=</span>~ <span class="o">[</span><span class="nv">$tfam</span><span class="o">]</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">tdest</span><span class="o">=</span>i34X<span class="si">${</span><span class="nv">tfam</span><span class="si">}</span> <span class="o">||</span> <span class="nv">tdest</span><span class="o">=</span>i34XAB

      <span class="c1"># if ocnt=X, create layout/family</span>
      <span class="k">if</span> <span class="o">[[</span> <span class="nv">$ocnt</span> <span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
        layoutcreate <span class="nv">$trg</span>
      <span class="k">else</span>
        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$tdest</span> <span class="o">=</span> i34XAB <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
          familycreate <span class="nv">$trg</span>
        <span class="k">else</span>
          i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">]&quot;</span> move to workspace <span class="si">${</span><span class="nv">gla</span><span class="p">[AWW]</span><span class="si">}</span>, <span class="se">\</span>
            floating disable, move to mark <span class="si">${</span><span class="nv">tdest</span><span class="si">}</span>
        <span class="k">fi</span>

        <span class="nv">swap</span><span class="o">=</span><span class="m">0</span>
        <span class="o">[[</span> <span class="nv">$tdest</span> <span class="o">=</span> i34XAB <span class="o">]]</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> <span class="o">((</span>tpos%2<span class="o">==</span><span class="m">1</span><span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="nv">swap</span><span class="o">=(</span><span class="s2">&quot;X</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">&quot;</span> <span class="s2">&quot;X</span><span class="si">${</span><span class="nv">gla</span><span class="p">[ALL]/</span><span class="nv">$tfam</span><span class="p">/</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
        <span class="o">[[</span> <span class="nv">$tdest</span> <span class="o">=</span> i34X<span class="si">${</span><span class="nv">tfam</span><span class="si">}</span> <span class="o">]]</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> <span class="o">((</span>tpos&lt;<span class="m">3</span><span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="nv">swap</span><span class="o">=(</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span> <span class="si">${</span><span class="nv">tfam</span><span class="p">/</span><span class="nv">$trg</span><span class="p">/</span><span class="si">}</span><span class="o">)</span>
        <span class="o">[[</span> <span class="nv">$swap</span> !<span class="o">=</span> <span class="m">0</span> <span class="o">]]</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">swap</span><span class="p">[0]</span><span class="si">}</span><span class="s2">]&quot;</span> <span class="se">\</span>
             swap container with mark i34<span class="si">${</span><span class="nv">swap</span><span class="p">[1]</span><span class="si">}</span>


        <span class="c1"># resizing</span>
        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$tdest</span> <span class="o">=</span> i34XAB <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
          <span class="nv">tspl</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SAB]</span><span class="si">}</span> <span class="nv">tdim</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span> <span class="nv">sdir</span><span class="o">=</span>width <span class="nv">tmrk</span><span class="o">=</span>i34XAC
        <span class="k">else</span>
          <span class="nv">tspl</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> <span class="nv">tdim</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span> <span class="nv">sdir</span><span class="o">=</span>height <span class="nv">tmrk</span><span class="o">=</span>i34<span class="si">${</span><span class="nv">tfam</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
        <span class="k">fi</span>

        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$tspl</span> !<span class="o">=</span> X <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="nv">$tspl</span> !<span class="o">=</span> <span class="nv">$tdim</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
          <span class="nv">sajz</span><span class="o">=(</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$tspl</span> <span class="nv">$tdim</span> <span class="p">|</span> awk <span class="s1">&#39;{</span>
<span class="s1">            tperc=$1/$2*100</span>
<span class="s1">            if(tperc&gt;50){sperc=tperc-50;sdir=&quot;grow&quot;}</span>
<span class="s1">            if(tperc&lt;50){sperc=50-tperc;sdir=&quot;shrink&quot;}</span>
<span class="s1">            if(tperc==50){sperc=50}</span>
<span class="s1">            print sperc &quot; &quot; sdir</span>
<span class="s1">          }&#39;</span><span class="k">)</span><span class="o">)</span>

          <span class="o">[[</span> <span class="si">${</span><span class="nv">sajz</span><span class="p">[0]</span><span class="si">}</span> !<span class="o">=</span> <span class="m">50</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> i3-msg -q <span class="s2">&quot;[con_mark=</span><span class="nv">$tmrk</span><span class="s2">]&quot;</span> <span class="se">\</span>
            resize <span class="si">${</span><span class="nv">sajz</span><span class="p">[1]</span><span class="si">}</span> <span class="nv">$sdir</span> <span class="si">${</span><span class="nv">sajz</span><span class="p">[0]%.*</span><span class="si">}</span> px or <span class="si">${</span><span class="nv">sajz</span><span class="p">[0]%.*</span><span class="si">}</span> ppt
        <span class="k">fi</span>
      <span class="k">fi</span>
      gla<span class="o">[</span>VIS<span class="o">]</span>+<span class="o">=</span><span class="nv">$trg</span>
      gla<span class="o">[</span>HID<span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[HID]/</span><span class="nv">$trg</span><span class="p">/</span><span class="si">}</span>
      dothelo
    <span class="p">;;</span>
  <span class="k">esac</span>
<span class="o">}</span>

containercreate<span class="o">(){</span>
  <span class="nb">local</span> trg 

  <span class="nv">trg</span><span class="o">=</span><span class="nv">$1</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[TWI]</span><span class="si">}</span> <span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">eval</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">command</span><span class="si">}</span><span class="s2">&quot;</span> &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span> 
    gla<span class="o">[</span>TWI<span class="o">]=</span><span class="k">$(</span>i3get <span class="si">${</span><span class="nv">crit</span><span class="si">}</span> -y<span class="k">)</span>
  <span class="k">fi</span>

  i3gw gurra  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> <span class="se">\</span>
    split h, layout tabbed
  i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[TWI]</span><span class="si">}</span><span class="s2">]&quot;</span> <span class="se">\</span>
    floating disable, move to mark gurra
  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> <span class="se">\</span>
    focus, focus parent
  i3-msg -q mark i34<span class="si">${</span><span class="nv">trg</span><span class="si">}</span>
  i3-msg -q <span class="s2">&quot;[con_mark=gurra]&quot;</span> <span class="nb">kill</span>
    
  <span class="c1"># after creation, move cont to scratch</span>
  i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">]&quot;</span> focus, floating enable, <span class="se">\</span>
    move absolute position <span class="m">0</span> px <span class="m">0</span> px, <span class="se">\</span>
    resize <span class="nb">set</span> <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span> px <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span> px, <span class="se">\</span>
    move scratchpad
  <span class="c1"># add to trg to hid</span>
  gla<span class="o">[</span>HID<span class="o">]</span>+<span class="o">=</span><span class="nv">$trg</span>
  <span class="c1"># run container show to show container</span>
  containershow <span class="nv">$trg</span>
<span class="o">}</span>

containerhide<span class="o">(){</span>
  <span class="nb">local</span> trg tfam famchk tfammem
  
  <span class="nv">trg</span><span class="o">=</span><span class="nv">$1</span>

  <span class="o">[[</span> <span class="nv">$trg</span> <span class="o">=</span>~ A<span class="p">|</span>C <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">tfam</span><span class="o">=</span>AC <span class="nv">tfammem</span><span class="o">=</span><span class="nv">$FAC</span> <span class="o">||</span> <span class="nv">tfam</span><span class="o">=</span>BD <span class="nv">tfammem</span><span class="o">=</span><span class="nv">$FBD</span>

  i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">]&quot;</span> focus, floating enable, <span class="se">\</span>
    move absolute position <span class="m">0</span> px <span class="m">0</span> px, <span class="se">\</span>
    resize <span class="nb">set</span> <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span> px <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span> px, <span class="se">\</span>
    move scratchpad
  <span class="c1"># add to trg to hid</span>
  gla<span class="o">[</span>HID<span class="o">]</span>+<span class="o">=</span><span class="nv">$trg</span>
  gla<span class="o">[</span>VIS<span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]/</span><span class="nv">$trg</span><span class="p">/</span><span class="si">}</span>
  gla<span class="o">[</span>VIS<span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="k">:-</span><span class="nv">X</span><span class="si">}</span>

  <span class="c1"># if trg is last of it&#39;s fam, note it.</span>
  <span class="nv">famchk</span><span class="o">=</span><span class="si">${</span><span class="nv">tfam</span><span class="p">/</span><span class="nv">$trg</span><span class="p">/</span><span class="si">}</span>

  <span class="k">if</span> <span class="o">[[</span> ! <span class="nv">$famchk</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$tfammem</span> <span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      i3gw <span class="s2">&quot;i34F</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">&quot;</span>  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34F</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">]&quot;</span> move scratchpad
    <span class="k">else</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34F</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">tfammem</span><span class="si">}</span><span class="s2">]&quot;</span> mark <span class="s2">&quot;i34W</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">fi</span>
  <span class="k">fi</span>

  <span class="c1"># note splits</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span> !<span class="o">=</span> X <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span> -ne <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span><span class="k">))</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span> -ne <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[SAB]</span><span class="si">}</span> <span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      i3gw <span class="s2">&quot;i34SAB_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span><span class="s2">&quot;</span>  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34SAB_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span><span class="s2">]&quot;</span> move scratchpad
    <span class="k">else</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34SAB_]&quot;</span> unmark, mark <span class="s2">&quot;i34SAB_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">fi</span>
    gla<span class="o">[</span>SAB<span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[CAB]</span><span class="si">}</span>
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> !<span class="o">=</span> X <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> -ne <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span><span class="k">))</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> -ne <span class="k">$((</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span><span class="o">/</span><span class="m">2</span><span class="k">))</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span> <span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      i3gw <span class="s2">&quot;i34S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>  &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> move scratchpad
    <span class="k">else</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span> mark <span class="s2">&quot;i34S</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">fi</span>
    gla<span class="o">[</span>S<span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[C</span><span class="si">${</span><span class="nv">tfam</span><span class="si">}</span><span class="p">]</span><span class="si">}</span>
  <span class="k">fi</span>

  dothelo
<span class="o">}</span>

swapmeet<span class="o">(){</span>
  <span class="nb">local</span> <span class="nv">m1</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nb">local</span> <span class="nv">m2</span><span class="o">=</span><span class="nv">$2</span>
  <span class="nb">local</span> i k cur
  <span class="nb">local</span> exc <span class="c1"># existintg containers</span>
  <span class="nb">declare</span> -A acn <span class="c1"># array with containers (k=current name, v=twin name)</span>

  i3-msg -q <span class="s2">&quot;[con_mark=</span><span class="si">${</span><span class="nv">m1</span><span class="si">}</span><span class="s2">]&quot;</span> swap mark <span class="si">${</span><span class="nv">m2</span><span class="si">}</span>, mark i34tmp
  i3-msg -q <span class="s2">&quot;[con_mark=</span><span class="si">${</span><span class="nv">m2</span><span class="si">}</span><span class="s2">]&quot;</span> mark <span class="si">${</span><span class="nv">m1</span><span class="si">}</span>
  i3-msg -q <span class="s2">&quot;[con_mark=i34tmp]&quot;</span> mark <span class="si">${</span><span class="nv">m2</span><span class="si">}</span>

  <span class="c1"># if targets are families, remark all containers with their twins</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$m1</span> <span class="o">=</span>~ X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">tspl</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SAB]</span><span class="si">}</span> <span class="nv">tdim</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDW]</span><span class="si">}</span> <span class="nv">sdir</span><span class="o">=</span>width <span class="nv">tmrk</span><span class="o">=</span>i34XAC
    <span class="nv">exc</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span>
    <span class="nb">echo</span> <span class="s2">&quot;family swapfest, remarking </span><span class="nv">$exc</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="o">((</span> <span class="nv">i</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span> i &lt; <span class="si">${#</span><span class="nv">exc</span><span class="si">}</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
      <span class="nv">cur</span><span class="o">=</span><span class="si">${</span><span class="nv">exc</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
      <span class="k">case</span> <span class="nv">$cur</span> in
        A <span class="o">)</span> acn<span class="o">[</span><span class="nv">$cur</span><span class="o">]=</span>B <span class="p">;;</span>
        B <span class="o">)</span> acn<span class="o">[</span><span class="nv">$cur</span><span class="o">]=</span>A <span class="p">;;</span>
        C <span class="o">)</span> acn<span class="o">[</span><span class="nv">$cur</span><span class="o">]=</span>D <span class="p">;;</span>
        D <span class="o">)</span> acn<span class="o">[</span><span class="nv">$cur</span><span class="o">]=</span>C <span class="p">;;</span>
      <span class="k">esac</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">cur</span><span class="si">}</span><span class="s2">]&quot;</span> mark i34tmp<span class="si">${</span><span class="nv">cur</span><span class="si">}</span>
    <span class="k">done</span>
    <span class="k">for</span> k in <span class="si">${</span><span class="p">!acn[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
      i3-msg -q <span class="s2">&quot;[con_mark=i34tmp</span><span class="si">${</span><span class="nv">k</span><span class="si">}</span><span class="s2">]&quot;</span> mark i34<span class="si">${</span><span class="nv">acn</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="si">}</span>
      <span class="nb">echo</span> <span class="s2">&quot;remarking </span><span class="nv">$k</span><span class="s2"> -&gt; </span><span class="si">${</span><span class="nv">acn</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">done</span>
  <span class="k">else</span>
    <span class="o">[[</span> <span class="nv">$tfam</span> <span class="o">=</span> AC <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">tspl</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SAC]</span><span class="si">}</span> <span class="o">||</span> <span class="nv">tspl</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SBD]</span><span class="si">}</span>
    <span class="nv">tdim</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[SDH]</span><span class="si">}</span> <span class="nv">sdir</span><span class="o">=</span>height <span class="nv">tmrk</span><span class="o">=</span>i34<span class="si">${</span><span class="nv">tfam</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
  <span class="k">fi</span>

  <span class="c1"># invert split</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$tspl</span> !<span class="o">=</span> X <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="nv">$tspl</span> !<span class="o">=</span> <span class="nv">$tdim</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">tspl</span><span class="o">=</span><span class="k">$((</span>tdim-tspl<span class="k">))</span>
    <span class="nv">sajz</span><span class="o">=(</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$tspl</span> <span class="nv">$tdim</span> <span class="p">|</span> awk <span class="s1">&#39;{</span>
<span class="s1">      tperc=$1/$2*100</span>
<span class="s1">      if(tperc&gt;50){sperc=(tperc-50)*2;sdir=&quot;grow&quot;}</span>
<span class="s1">      if(tperc&lt;50){sperc=(50-tperc)*2;sdir=&quot;shrink&quot;}</span>
<span class="s1">      if(tperc==50){sperc=50}</span>
<span class="s1">      print sperc &quot; &quot; sdir</span>
<span class="s1">    }&#39;</span><span class="k">)</span><span class="o">)</span>
    <span class="nb">echo</span> <span class="s2">&quot;sss </span><span class="si">${</span><span class="nv">sajz</span><span class="p">[@]</span><span class="si">}</span><span class="s2"> </span><span class="nv">$sdir</span><span class="s2"> </span><span class="nv">$tmrk</span><span class="s2">&quot;</span>
    <span class="o">[[</span> <span class="si">${</span><span class="nv">sajz</span><span class="p">[0]</span><span class="si">}</span> !<span class="o">=</span> <span class="m">50</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> i3-msg <span class="s2">&quot;[con_mark=</span><span class="nv">$tmrk</span><span class="s2">]&quot;</span> <span class="se">\</span>
      resize <span class="si">${</span><span class="nv">sajz</span><span class="p">[1]</span><span class="si">}</span> <span class="nv">$sdir</span> <span class="si">${</span><span class="nv">sajz</span><span class="p">[0]%.*</span><span class="si">}</span> px or <span class="si">${</span><span class="nv">sajz</span><span class="p">[0]%.*</span><span class="si">}</span> ppt
  <span class="k">fi</span>
<span class="o">}</span>

containerrename<span class="o">(){</span>

  <span class="nb">local</span> oname nname tvis

  <span class="nv">oname</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nv">nname</span><span class="o">=</span><span class="nv">$2</span>

  <span class="c1"># get visibility of target</span>
  <span class="o">[[</span> <span class="nv">$oname</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
    <span class="o">&amp;&amp;</span> gla<span class="o">[</span>VIS<span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]/</span><span class="nv">$oname</span><span class="p">/</span><span class="nv">$nname</span><span class="si">}</span> <span class="se">\</span>
    <span class="o">||</span> gla<span class="o">[</span>HID<span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[HID]/</span><span class="nv">$oname</span><span class="p">/</span><span class="nv">$nname</span><span class="si">}</span>

  i3-msg -q <span class="s2">&quot;[con_mark=i34</span><span class="si">${</span><span class="nv">oname</span><span class="si">}</span><span class="s2">]&quot;</span> mark i34<span class="si">${</span><span class="nv">nname</span><span class="si">}</span>

  dothelo
<span class="o">}</span>

togglefloat<span class="o">(){</span>
  <span class="c1"># get floting state of current window</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[AWP]</span><span class="si">}</span> <span class="o">=</span> g <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="c1"># it floats</span>
    <span class="c1"># make current tiled and put it in first found visible container</span>
    <span class="c1"># if no visible container, first found hidden container</span>
    <span class="c1"># if none exist create A</span>

    <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span> !<span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">trg</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
    <span class="k">elif</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">gla</span><span class="p">[HID]</span><span class="si">}</span> !<span class="o">=</span> X <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">trg</span><span class="o">=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[HID]:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
    <span class="k">else</span>
      <span class="nv">trg</span><span class="o">=</span>A
    <span class="k">fi</span>

    <span class="c1"># if $trg doesn&#39;t exist, create it.</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$trg</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[EXS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      containershow <span class="nv">$trg</span>
      i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWI]</span><span class="si">}</span><span class="s2">]&quot;</span> floating disable, <span class="se">\</span>
        move to mark <span class="s2">&quot;i34</span><span class="si">${</span><span class="nv">trg</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span>
      containershow <span class="nv">$trg</span>
    <span class="k">fi</span>
  <span class="k">else</span>
    <span class="c1"># window is tiled, make it float</span>
    i3-msg -q <span class="s2">&quot;[con_id=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[AWI]</span><span class="si">}</span><span class="s2">]&quot;</span> floating <span class="nb">enable</span>
  <span class="k">fi</span>
<span class="o">}</span>

dothelo<span class="o">(){</span>
  <span class="nb">local</span> fill k i cfill
  <span class="k">for</span> k in <span class="si">${</span><span class="p">!def[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
    loa<span class="o">[</span><span class="nv">$k</span><span class="o">]=</span><span class="si">${</span><span class="nv">def</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="si">}</span>
    <span class="o">[[</span> ! <span class="si">${</span><span class="nv">def</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="si">}</span> <span class="o">=</span>~ <span class="o">[</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span><span class="o">]</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">fill</span><span class="o">+=</span><span class="s2">&quot;</span><span class="nv">$k</span><span class="s2">&quot;</span>
  <span class="k">done</span>

  <span class="o">[[</span> <span class="si">${#</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span> <span class="o">=</span> <span class="m">0</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> gla<span class="o">[</span>VIS<span class="o">]=</span>X

  <span class="k">if</span> <span class="o">[[</span> <span class="si">${#</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span> <span class="o">=</span>~ <span class="m">2</span><span class="p">|</span><span class="m">3</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">for</span> <span class="o">((</span> <span class="nv">i</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span> i &lt; <span class="si">${#</span><span class="nv">fill</span><span class="si">}</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
      <span class="nv">cfill</span><span class="o">=</span><span class="si">${</span><span class="nv">fill</span><span class="p">:</span><span class="nv">$i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
      <span class="k">if</span> <span class="o">((</span>cfill&lt;<span class="m">3</span><span class="o">))</span><span class="p">;</span> <span class="k">then</span>
        <span class="o">[[</span> ! <span class="k">$((</span>cfill+2<span class="k">))</span> <span class="o">=</span>~ <span class="o">[</span><span class="nv">$fill</span><span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> loa<span class="o">[</span><span class="nv">$cfill</span><span class="o">]=</span><span class="si">${</span><span class="nv">def</span><span class="p">[</span><span class="k">$((</span>cfill+2<span class="k">))</span><span class="p">]</span><span class="si">}</span> <span class="o">&amp;&amp;</span> <span class="k">continue</span>
      <span class="k">else</span>
        <span class="o">[[</span> ! <span class="k">$((</span>cfill-2<span class="k">))</span> <span class="o">=</span>~ <span class="o">[</span><span class="nv">$fill</span><span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> loa<span class="o">[</span><span class="nv">$cfill</span><span class="o">]=</span><span class="si">${</span><span class="nv">def</span><span class="p">[</span><span class="k">$((</span>cfill-2<span class="k">))</span><span class="p">]</span><span class="si">}</span> <span class="o">&amp;&amp;</span> <span class="k">continue</span>
      <span class="k">fi</span>

      <span class="k">if</span> <span class="o">((</span>cfill%2<span class="o">==</span><span class="m">1</span><span class="o">))</span><span class="p">;</span> <span class="k">then</span>
        <span class="o">[[</span> ! <span class="k">$((</span>cfill+1<span class="k">))</span> <span class="o">=</span>~ <span class="o">[</span><span class="nv">$fill</span><span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> loa<span class="o">[</span><span class="nv">$cfill</span><span class="o">]=</span><span class="si">${</span><span class="nv">def</span><span class="p">[</span><span class="k">$((</span>cfill+1<span class="k">))</span><span class="p">]</span><span class="si">}</span> <span class="o">&amp;&amp;</span> <span class="k">continue</span>
      <span class="k">else</span>
        <span class="o">[[</span> ! <span class="k">$((</span>cfill-1<span class="k">))</span> <span class="o">=</span>~ <span class="o">[</span><span class="nv">$fill</span><span class="o">]</span> <span class="o">]]</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> loa<span class="o">[</span><span class="nv">$cfill</span><span class="o">]=</span><span class="si">${</span><span class="nv">def</span><span class="p">[</span><span class="k">$((</span>cfill-1<span class="k">))</span><span class="p">]</span><span class="si">}</span> <span class="o">&amp;&amp;</span> <span class="k">continue</span> 
      <span class="k">fi</span>  
    <span class="k">done</span>
  <span class="k">elif</span> <span class="o">[[</span> <span class="si">${#</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span> <span class="o">=</span> <span class="m">1</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    loa<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span>
    loa<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span>
    loa<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span>
    loa<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="si">${</span><span class="nv">gla</span><span class="p">[VIS]</span><span class="si">}</span>
  <span class="k">fi</span>
<span class="o">}</span>

<span class="k">while</span> <span class="nb">getopts</span> :vhas:c:l:w:z:m:p:f:t: option<span class="p">;</span> <span class="k">do</span>
  <span class="k">case</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">option</span><span class="si">}</span><span class="s2">&quot;</span> in
    v<span class="o">)</span> <span class="nb">printf</span> <span class="s1">&#39;%s\n%s\n&#39;</span> <span class="s2">&quot;</span><span class="nv">$NAME</span><span class="s2"> - version: </span><span class="nv">$VERSION</span><span class="s2">&quot;</span> <span class="se">\</span>
                         <span class="s2">&quot;updated: </span><span class="nv">$UPDATED</span><span class="s2"> by </span><span class="nv">$AUTHOR</span><span class="s2">&quot;</span> <span class="o">&amp;&amp;</span> exit<span class="p">;;</span>
    h<span class="o">)</span> <span class="nb">printf</span> <span class="s1">&#39;%s\n&#39;</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">about</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">&amp;&amp;</span> exit<span class="p">;;</span>
    a<span class="o">)</span> <span class="nv">cmd</span><span class="o">=</span>togglefloat <span class="o">&amp;&amp;</span> break<span class="p">;;</span>
    s<span class="o">)</span> <span class="nv">target</span><span class="o">=</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span> <span class="nv">cmd</span><span class="o">=</span>containershow <span class="p">;;</span>
    c<span class="o">)</span> <span class="nv">crit</span><span class="o">=</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span> <span class="p">;;</span>
    w<span class="o">)</span> <span class="nv">windowlist</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">;;</span>
    m<span class="o">)</span> <span class="nv">target</span><span class="o">=</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span> <span class="nv">cmd</span><span class="o">=</span>windowmove <span class="p">;;</span>
    z<span class="o">)</span> <span class="nv">cmd</span><span class="o">=</span>containerhide <span class="nv">target</span><span class="o">=</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span> <span class="p">;;</span>
    f<span class="o">)</span> <span class="nv">cmd</span><span class="o">=</span>windowfocus <span class="nv">target</span><span class="o">=</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span> <span class="p">;;</span>
    t<span class="o">)</span> <span class="nv">cmd</span><span class="o">=</span>tabswitch <span class="nv">target</span><span class="o">=</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span> <span class="p">;;</span>
    l<span class="o">)</span> <span class="nv">cmd</span><span class="o">=</span>applysplits <span class="nv">target</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">;;</span>
    p<span class="o">)</span> <span class="nv">speed</span><span class="o">=</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span> <span class="p">;;</span>
  <span class="k">esac</span>
<span class="k">done</span>

<span class="nv">alst</span><span class="o">=(</span><span class="si">${</span><span class="nv">windowlist</span><span class="p">:=</span><span class="k">$(</span>i3list<span class="k">)</span><span class="si">}</span><span class="o">)</span>
<span class="nb">declare</span> -A gla <span class="c1"># globals array</span>
<span class="nb">declare</span> -a def <span class="c1"># default container positions array</span>
<span class="nb">declare</span> -a loa <span class="c1"># actual container positions array</span>

initglobals

dothelo <span class="c1"># setup actual layout array: loa</span>

<span class="si">${</span><span class="nv">cmd</span><span class="si">}</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">target</span><span class="si">}</span><span class="s2">&quot;</span> <span class="c1"># run command</span>
</code></pre></div>
</div>
<hr>


<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'budRich';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</article>



<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-75784183-1', 'auto');
ga('send', 'pageview');
</script>



</body>
</html>

